@page "/weather"
@rendermode InteractiveServer

<PageTitle>Weather</PageTitle>

<div class="card-glass">
    <h1>Weather</h1>

    <p>It is only used for practice, so this component demonstrates the use of local simulation display data.</p>

    @if (forecasts == null)
    {
        <p><em>Loading or generating weather data...</em></p>
    }
    else
    {
        <table class="table" style="color: #fff;">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Temp. (C)</th>
                    <th>Temp. (F)</th>
                    <th>Summary</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var forecast in forecasts)
                {
                    <tr>
                        <td>@forecast.Date.ToShortDateString()</td>
                        <td>@forecast.TemperatureC</td>
                        <td>@forecast.TemperatureF</td>
                        <td>@forecast.Summary</td>
                    </tr>
                }
            </tbody>
        </table>
    }
</div>


@code {
    private WeatherForecast[]? forecasts;

    // 我們不再注入 HttpClient，因為不需要從網路抓資料了
    // @inject HttpClient Http

    protected override async Task OnInitializedAsync()
    {
        // 模擬一個網路延遲，讓 "Loading..." 有機會顯示
        await Task.Delay(500);

        // 直接呼叫一個方法來產生假資料
        GenerateMockData();
    }

    private void GenerateMockData()
    {
        var summaries = new[]
        {
            "晴天", "多雲", "偶有陣雨", "雷陣雨", "酷熱", "涼爽", "有風", "嚴寒", "溫暖"
        };

        // 產生未來五天的天氣預報
        forecasts = Enumerable.Range(1, 5).Select(index => new WeatherForecast
        {
            Date = DateOnly.FromDateTime(DateTime.Now.AddDays(index)),
            TemperatureC = Random.Shared.Next(-5, 35),
            Summary = summaries[Random.Shared.Next(summaries.Length)]
        }).ToArray();
    }

    public class WeatherForecast
    {
        public DateOnly Date { get; set; }
        public int TemperatureC { get; set; }
        public string? Summary { get; set; }
        public int TemperatureF => 32 + (int)(TemperatureC / 0.5556);
    }
}

